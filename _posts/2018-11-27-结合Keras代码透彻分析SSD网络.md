---
layout: post
title: "结合Keras代码透彻分析SSD网络"
date: 2018-11-27
categories:
- 网络结构分析
tag:
- Keras
- SSD
---

之前一直在做分类网路的工作，物体检测网络有了解，但是还没有从头训练过，这次通过几天时间的集中学习，终于理解了整个网络的大部分细节，这里作简要记录。

### 思维导图
<img src="/assets/images/posts/ssd/SSD.png">

### 简要总结
- **网络部分：** 最终输出的是一个封装好的数据，封装的什么呢？三部分，1、每个default box的分类损失，2、每个default box的回归损失，3、生成的default box的坐标，长度为8，四个坐标加上四个varance值辅助训练。
- **数据部分：**我么先读取训练数据，可以获得gt box的两个坐标以及所属类别，然后我们也知道，并不是多有的default box都参与训练，而是符合一定要求的才参与训练（IOU大于阈值，并且一个default box只对应一个gt box），经过筛选后，每个gt box会和一个或几个default box对应，此时我们称这些default box为prior box，这也是很多博客里面说的，default box是客观存在的，不管你输入是是什么，而prior box是实际采用的，因为随着图片的不同，gt box的位置不同，prior box也不同。最后再对原始的绝对坐标进行编码。
- **损失部分：**损失是计算上述两者的输出，均是(-1,num\_default\_box,4+21+8)(在VOC2007下，base model为VGG16)，在损失这部分还有一个值得注意的地方就是hard mining，通过控制正负样本的比例来辅助训练。

### 代码
随后我会将代码(参考：[Github](https://github.com/rykov8/ssd_keras/blob/master/SSD.ipynb))上传到我的github上，对比参考的代码，我只是在里面添加了中文注释，并根据最新版本的keras进行了API修改。
